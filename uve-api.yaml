openapi: 3.0.1
servers:
  - url: https://api.uve.demo.ubirch.com:8443/
    description: Universal Verification Endpoint- STAGING api server
info:
  title: Universal Verification Endpoint API
  description: |
    A universal verification endpoint for different types of certificates. For example the
    [Digital Covid Certificate (DCC)](https://github.com/ehn-digital-green-development/ehn-dcc-schema)
    conforming certificates.

    ```
    Copyright (C) 2021 ubirch GmbH

    Licensed under the Apache License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    https://www.apache.org/licenses/LICENSE-2.0

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
    ```

  version: 1.0.0
  license:
    name: 'Apache License, Version 2.0'
    url: 'https://www.apache.org/licenses/LICENSE-2.0'
  contact:
    name: UBIRCH GmbH
    url: https://ubirch.com
    email: uve-support@ubirch.com

paths:
  /api/uve/v1/verify:
    post:
      tags:
        - Verification
      summary: Verify a certificate for authenticity.
      description: |
        # Description

        Checks the signature and verifies the authenticity of a
        [Digital Covid Certificate (DCC)](https://github.com/ehn-digital-green-development/ehn-dgc-schema/).
      parameters:
            - in: header
              name: X-Transaction-Id
              description: A random and unique transaction id for every request against the api used for accounting generated by the user. 
              schema: 
                type: string
              example: "2b98009c-d4f6-11eb-8a22-1e00312e7f59"
              required: true
            - in: header
              name: X-Transaction-Tag
              description: An (optional) random tag used for accounting specified by the user. 
              schema: 
                type: string
              example: "AirportCheckIn42"
              required: false
      requestBody:
        description: >-
          The encoded representation of a certificate.
        content:
          application/cbor+base45:
            schema:
              $ref: '#/components/schemas/CertificateEncoded'
      responses:
        '200':
          description: Certificate is authentic.
          content:
            application/json:
              schema:
                $ref: '#/components/schemas/DigicalCovidCertificate'
        '400':
          description: Invalid certificate
        '406':
          description: Incorrect data model
        '500':
          description: Internal Server Error

components:
  schemas:
    DigicalCovidCertificate:
      '$ref': 'schema/DCC.combined-schema.json'

    CertificateEncoded:
      description: >-
        Base45 encoded and compressed Digital Corona Certificate (DCC) according to EU specification. An encoded
        certificate can be directly rendered as a QR code according to the EU specification.
      type: string
      format: base45
      example: "HC1:6BFOXN*TS0BI$ZD-PHQ7I9AD66V5B2769Y3S3XHP+56R5KE9N1N*CMHZ4%VDLDM:UC*GPXS40 LHZA KEJ*G%9DJ6K1AD1WMN+I0JK1WLC846GTUMJ/X0TZ0JHJRUV% 0F29+47WTJ3%89$G9CBONBSZ4SL0EN9UKP0T9WC5PF6846A$QY76LZ6499FQ5VA131A.V56GAU3QO6QE3VTK5KJPB95ZE9Q$95:UENEUW6200DM88Q9*$K8KG+9RR$F+ F.N80N8SN40%KLR2A KZ*U0I1-I0*OC6H0/VMNPM*S5QJ3J$HTR9/O15SI:TU+MM0W5X*H V1Y$6SZ4RZ4E%5MK9AZP0W5E%5TW5CL51R5QK95R91Y9%PP4T9 UP%NPBT17$1MV15K1:O1F/9BL5H1VTS1RVEG%5TW5A 6YO67N6ECE7%NR72. S%GCP-JU6J2*2$F20OMRGT555Z2OBLGJ2TBN3A.H$XLIAOTBM07DFU7R76B9BTDC-LQ.X8.9NRQJD8W7HOL+U7A2.4OC/T340AMRD0"      
